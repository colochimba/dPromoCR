{"version":3,"sources":["webpack:///./src/app/models/message.ts","webpack:///./src/app/oferta-detalle/oferta-detalle.module.ts","webpack:///./src/app/oferta-detalle/oferta-detalle.page.html","webpack:///./src/app/oferta-detalle/oferta-detalle.page.scss","webpack:///./src/app/oferta-detalle/oferta-detalle.page.ts","webpack:///./src/app/servicios/comm.service.ts"],"names":[],"mappings":"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","file":"oferta-detalle-oferta-detalle-module.js","sourcesContent":["export class Message {\n    key?: string;\n    userName?: string;\n    message?: string;\n    timeSent?: string;\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { OfertaDetallePage } from './oferta-detalle.page';\n\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: OfertaDetallePage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [OfertaDetallePage]\n})\nexport class OfertaDetallePageModule {}\n","module.exports = \"<ion-header translucent>\\n    <ion-toolbar color=\\\"dark\\\">\\n        <ion-buttons slot=\\\"start\\\">\\n            <ion-back-button></ion-back-button>\\n        </ion-buttons>\\n        <ion-title>\\n            Detalle de la Oferta\\n        </ion-title>\\n    </ion-toolbar>\\n</ion-header>\\n\\n<ion-content class=\\\"\\\" color=\\\"dark\\\">\\n    <ion-slides pager=\\\"true\\\" [options]=\\\"slideOpts\\\">\\n        <ion-slide>\\n            <ion-card color=\\\"light\\\">\\n                <ion-card-header>\\n                    <ion-img [src]=\\\"ofertaDetalle.promoPhotoURL\\\"></ion-img>\\n                </ion-card-header>\\n            </ion-card>\\n        </ion-slide>\\n\\n        <ion-slide>\\n            <ion-card color=\\\"light\\\">\\n                <ion-card-header>\\n                    <ion-img src=\\\"https://via.placeholder.com/450x250\\\"></ion-img>\\n                </ion-card-header>\\n            </ion-card>\\n        </ion-slide>\\n\\n        <ion-slide>\\n            <ion-card color=\\\"light\\\">\\n                <ion-card-header>\\n                    <ion-img src=\\\"https://via.placeholder.com/450x250\\\"></ion-img>\\n                </ion-card-header>\\n            </ion-card>\\n        </ion-slide>\\n\\n        <ion-slide>\\n            <ion-card color=\\\"light\\\">\\n                <ion-card-header>\\n                    <ion-img src=\\\"https://via.placeholder.com/450x250\\\"></ion-img>\\n                </ion-card-header>\\n            </ion-card>\\n        </ion-slide>\\n\\n        <ion-slide>\\n            <ion-card color=\\\"light\\\">\\n                <ion-card-header>\\n                    <ion-img src=\\\"https://via.placeholder.com/450x250\\\"></ion-img>\\n                </ion-card-header>\\n            </ion-card>\\n        </ion-slide>\\n\\n        <ion-slide>\\n            <ion-card color=\\\"light\\\">\\n                <ion-card-header>\\n                    <ion-img src=\\\"https://via.placeholder.com/450x250\\\"></ion-img>\\n                </ion-card-header>\\n            </ion-card>\\n        </ion-slide>\\n    </ion-slides>\\n\\n    <ion-card color=\\\"light\\\">\\n        <h2>Detalle:</h2>\\n        <p>{{ofertaDetalle.promoDescription}}</p>\\n        <ion-grid>\\n            <ion-row>\\n                <ion-col>\\n                    <strong>Lugar: {{ofertaDetalle.promoPlace}}</strong> <br>\\n                    <strong>Vence: {{ofertaDetalle.promoDate}}</strong>\\n                </ion-col>\\n                <ion-col>\\n                    <strong>Tel: {{ofertaDetalle.promoTel}}</strong><br>\\n                    <strong>Web: {{ofertaDetalle.promoWeb}}</strong>\\n                </ion-col>\\n            </ion-row>\\n        </ion-grid>\\n        <ng-template [ngIf]=\\\"this.authService.currentUser.active && this.unusedPromo(ofertaDetalle.promoID)\\\" [ngIfElse]=\\\"deactive\\\">\\n            <ion-button color='primary' expand=\\\"full\\\" (click)=\\\"canjearCupon()\\\">Canjear Cupón</ion-button>\\n        </ng-template>\\n        <ng-template #deactive>\\n            <ion-button color='medium' expand=\\\"full\\\" (click)='presentAlertConfirm()'>Canjear Cupón</ion-button>\\n        </ng-template>\\n\\n    </ion-card>\\n    <!-- Loagind bar Deberiamos tambien deshabilitar el resto de la pantalla mientras esta esperando....-->\\n    <ng-container *ngIf=\\\"this.waiting\\\">\\n        <ion-list-header>\\n            <ion-label id=\\\"loadingLabel\\\">\\n                Esperando\\n            </ion-label>\\n            <ion-spinner name=\\\"bubbles\\\"></ion-spinner>\\n        </ion-list-header>\\n    </ng-container>\\n    <!-- List of Text Items -->\\n    <ion-list>\\n        <ion-item class=\\\"item ios in-list ion-focusable item-label hydrated\\\" *ngFor=\\\"let oferta of recomendaciones\\\">\\n            <a (click)=\\\"presentOferta(oferta)\\\" routerLink=\\\"/oferta-detalle\\\">\\n                <ion-avatar slot=\\\"start\\\" class=\\\"ios hydrated\\\">\\n                    <img [src]=\\\"oferta.promoPhotoURL\\\">\\n                </ion-avatar>\\n                <ion-label class=\\\"sc-ion-label-ios-h sc-ion-label-ios-s ios hydrated\\\">\\n                    <h2>{{oferta.promoBusiness}}</h2>\\n                    <h3>{{oferta.promoName}}</h3>\\n                    <p>{{oferta.promoDescription}}</p>\\n                </ion-label>\\n            </a>\\n        </ion-item>\\n    </ion-list>\\n</ion-content>\"","module.exports = \"a {\\n  text-decoration: none; }\\n\\nion-card-header {\\n  padding: 0; }\\n\\nion-card-content {\\n  padding-top: 10px; }\\n\\n.swiper-container-horizontal > .swiper-pagination-bullets {\\n  bottom: 40px; }\\n\\nion-slides ion-card {\\n  padding: 0;\\n  margin: 10px 5px; }\\n\\nion-card {\\n  padding: 10px; }\\n\\nion-col ion-card {\\n  margin: 0; }\\n\\nion-icon {\\n  color: #a51838; }\\n\\nion-label {\\n  color: black !important;\\n  white-space: normal !important; }\\n\\nion-avatar {\\n  float: left;\\n  margin-right: 10px; }\\n\\nion-list-header {\\n  background-color: lightgray; }\\n\\nion-list-header ion-label {\\n    margin-left: auto; }\\n\\nion-list-header ion-spinner {\\n    margin-right: auto; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbGVqYW5kcm9hcmNlL0Rlc2t0b3AvTXlQcm9qZWN0cy9kUHJvbW9DUi1tYXN0ZXIvc3JjL2FwcC9vZmVydGEtZGV0YWxsZS9vZmVydGEtZGV0YWxsZS5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSxxQkFBcUIsRUFBQTs7QUFHekI7RUFDSSxVQUNKLEVBQUE7O0FBRUE7RUFDSSxpQkFDSixFQUFBOztBQUVBO0VBQ0ksWUFDSixFQUFBOztBQUVBO0VBRVEsVUFBVTtFQUNWLGdCQUFnQixFQUFBOztBQUl4QjtFQUNJLGFBQ0osRUFBQTs7QUFFQTtFQUNJLFNBQ0osRUFBQTs7QUFFQTtFQUNJLGNBQ0osRUFBQTs7QUFFQTtFQUNJLHVCQUF1QjtFQUN2Qiw4QkFBOEIsRUFBQTs7QUFHbEM7RUFDSSxXQUFXO0VBQ1gsa0JBQWtCLEVBQUE7O0FBR3RCO0VBQ0ksMkJBQTJCLEVBQUE7O0FBRC9CO0lBR1EsaUJBQWlCLEVBQUE7O0FBSHpCO0lBTVEsa0JBQWtCLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9vZmVydGEtZGV0YWxsZS9vZmVydGEtZGV0YWxsZS5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyJhIHtcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XG59XG5cbmlvbi1jYXJkLWhlYWRlciB7XG4gICAgcGFkZGluZzogMFxufVxuXG5pb24tY2FyZC1jb250ZW50IHtcbiAgICBwYWRkaW5nLXRvcDogMTBweFxufVxuXG4uc3dpcGVyLWNvbnRhaW5lci1ob3Jpem9udGFsPi5zd2lwZXItcGFnaW5hdGlvbi1idWxsZXRzIHtcbiAgICBib3R0b206IDQwcHhcbn1cblxuaW9uLXNsaWRlcyB7XG4gICAgaW9uLWNhcmQge1xuICAgICAgICBwYWRkaW5nOiAwO1xuICAgICAgICBtYXJnaW46IDEwcHggNXB4O1xuICAgIH1cbn1cblxuaW9uLWNhcmQge1xuICAgIHBhZGRpbmc6IDEwcHhcbn1cblxuaW9uLWNvbCBpb24tY2FyZCB7XG4gICAgbWFyZ2luOiAwXG59XG5cbmlvbi1pY29uIHtcbiAgICBjb2xvcjogI2E1MTgzOFxufVxuXG5pb24tbGFiZWwge1xuICAgIGNvbG9yOiBibGFjayAhaW1wb3J0YW50O1xuICAgIHdoaXRlLXNwYWNlOiBub3JtYWwgIWltcG9ydGFudDtcbn1cblxuaW9uLWF2YXRhciB7XG4gICAgZmxvYXQ6IGxlZnQ7XG4gICAgbWFyZ2luLXJpZ2h0OiAxMHB4O1xufVxuXG5pb24tbGlzdC1oZWFkZXIge1xuICAgIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0Z3JheTtcbiAgICBpb24tbGFiZWwge1xuICAgICAgICBtYXJnaW4tbGVmdDogYXV0bztcbiAgICB9XG4gICAgaW9uLXNwaW5uZXIge1xuICAgICAgICBtYXJnaW4tcmlnaHQ6IGF1dG87XG4gICAgfVxufSJdfQ== */\"","import { Component, OnInit, Input } from '@angular/core';\nimport { AlertController } from '@ionic/angular';\nimport { NavService } from '../servicios/nav.service';\nimport { AuthService } from '../servicios/auth.service';\nimport { CommService } from '../servicios/comm.service';\n\n\n@Component({\n  selector: 'app-oferta-detalle',\n  templateUrl: './oferta-detalle.page.html',\n  styleUrls: ['./oferta-detalle.page.scss']\n})\nexport class OfertaDetallePage implements OnInit {\n\n  ofertaDetalle\n  recomendaciones\n  public waiting: boolean = false;\n\n  slideOpts = {\n    slidesPerView: 1.1,\n    freeMode: true\n  };\n\n  constructor(public navParams: NavService, public authService: AuthService, private commService: CommService, public alertController: AlertController) {}\n\n  ngOnInit() {\n    this.ofertaDetalle = this.navParams.myParam.oferta;\n    this.recomendaciones = this.navParams.myParam.recomendaciones;\n  }\n\n  async presentAlertConfirm() {\n    const alert = await this.alertController.create({\n      header: 'Adquiere la Membresía!',\n      message: 'La Promo ya fue utilizada o necesita aquirir la Membresía DpromoCR',\n      buttons: [\n        {\n          text: 'Cancelar',\n          role: 'cancel',\n          cssClass: 'secondary',\n          handler: (blah) => {\n            console.log('Confirm Cancel: blah');\n          }\n        }, {\n          text: 'Membresía',\n          handler: () => {\n            window.location.href = \"/pago-membresia\";\n          }\n        }\n      ]\n    });\n\n    await alert.present();\n  }\n\n  presentOferta(ofertaActual){\n    let categoria = ofertaActual.promoCategory;\n\n    this.ofertaDetalle = ofertaActual;\n    this.recomendaciones =  this.navParams.destacadas.filter(oferta => oferta.promoCategory === categoria && oferta.promoID != ofertaActual.promoID);\n  }\n\n  //Este método debe enviar la notificación al negocio para aceptar el cupón.\n  //El negocio debe responder\n  //Si el cupon se va a canjear debe realizar lo siguiente\n  canjearCupon(){\n    var today = new Date();\n    var date = today.getDate()+'-'+(today.getMonth()+1)+'-'+today.getFullYear();\n    var time = today.getHours() + \":\" + today.getMinutes();\n    var dateTime = date+' '+time;\n    this.commService.sendMessage(this.ofertaDetalle.promoBusiness,this.ofertaDetalle.promoName, this.ofertaDetalle.promoDescription);\n    this.waiting = true;\n    this.get().then(()=>{\n      alert(\"Promoción aplicada correctamente!\");\n      this.waiting = false;\n    this.authService.currentUser.mispromos.push({\"promoID\":this.ofertaDetalle.promoID,\n                                                \"date\":dateTime,\n                                                \"name\":this.ofertaDetalle.promoName,\n                                                \"business\":this.ofertaDetalle.promoBusiness,\n                                                \"photo\":this.ofertaDetalle.promoPhotoURL,\n                                                \"description\": this.ofertaDetalle.promoDescription});\n    //update the user in DB\n    }).catch(err => {alert(\"Lo sentimos la promoción no aplica.\");this.waiting=false;});\n\n  }\n\n  //true si la promo no ha sido usada (guardada en mis promos)\n  //false si la promo ya fue usada y esta guardada en mis promos\n  unusedPromo(id){\n    for(let i=0; i < this.authService.currentUser.mispromos.length; i++){\n      if(this.authService.currentUser.mispromos[i].promoID == id){\n        return false;\n      }\n    }\n    return true;\n  }\n\n\n  async get(){\n    await this.commService.getMessages(this.ofertaDetalle.promoBusiness);\n   }\n}\n","import { Injectable } from '@angular/core';\nimport { AngularFireDatabase } from '@angular/fire/database';\nimport { Message } from '../models/message';\nimport { AuthService } from './auth.service';\nimport { Observable } from 'rxjs';\nimport { reject } from 'q';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CommService {\n\n  constructor(private authService: AuthService, private Afirebase: AngularFireDatabase) { }\n\n  sendMessage(businessName: string, promoName: string, promoDescription: string) {\n    const newpath = businessName;// nombre del negocio\n    const path = `message/${newpath}`;\n    var newmessage = new Message();\n     \n      var newPostKey = this.Afirebase.database.ref().child('path').push().key;\n      newmessage.key = newPostKey;\n      newmessage.userName = this.authService.currentUser.email;\n      newmessage.timeSent = this.getTimeStamp();\n      newmessage.message = \"Canjear cupón: \" + promoName + \". \" + promoDescription ;\n      this.Afirebase.database.ref(path).child(newPostKey).set({newmessage});\n    }\n\n   getMessages(businessName: string){\n    return new Promise((resolve,reject) => {\n      setTimeout(() => {\n        var userName = this.authService.currentUser.email;\n        var msgRef = this.Afirebase.database.ref('message/' + businessName);\n        msgRef.limitToLast(1).on('value', function(snapshot) {\n          if(snapshot.val() !== null){\n            var dMessage: Message = snapshot.child(JSON.stringify(snapshot.val()).split('\"')[1]).val().newmessage;\n            if(dMessage.userName !==  userName){ // if the last message is not sent by me\n              if(dMessage.message === 'Ok'){\n                resolve();\n              }else{\n                reject();\n              }\n            }\n          }\n        });\n        //reject();\n      }, 1000);\n    });\n  } \n  \n  getTimeStamp() {\n    const now = new Date();\n    const date = now.getUTCFullYear() + '/' +\n                (now.getUTCMonth() + 1) + '/' +\n                now.getUTCDate();\n    const time = now.getUTCHours() + ':' +\n                now.getUTCMinutes() + ':' +\n                now.getUTCSeconds();\n\n    return (date + ' ' + time);\n  }\n}\n"],"sourceRoot":""}